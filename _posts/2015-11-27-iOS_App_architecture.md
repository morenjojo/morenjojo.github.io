---
title: "iOS 应用架构"
layout: post
categories: [develop]
tags: [iOS]
excerpt: "常有人说，做移动端的app哪用得着那么麻烦，各种库都是现成的，往项目里一放就好了，何来架构？其实往简单了说，移动端app确实没有服务端那么复杂，性能方面的优化没有服务端那么迫切，拿数据展示数据就是app客户端的基本功能描述（移动端游戏不算）。要是往复杂了说，app客户端也是需要有好的架构的，如果你在一个多人协作的团队，应该会更有体会。接下来就说说iOS应用架构相关的。至于其他平台，技术有所不同但思想应该是一样的。"
---

#app客户端概述
如果你做的是工具类app，不需要依靠网络获取动态数据，那么恭喜，你可以省去很多；  
我所做过的大多数app，基本都是需要网络链接，调用api去获取数据来app展示的；  
简单来说就是调API，展示页面，然后跳转到别的地方再调API，再展示页面；

###app基本功能
- 调用网络api
- 页面展示
- 数据的本地持久化
- 动态不熟方案

###上面几点，细说一下就是：
- 如何让业务开发工程师方便安全地调用网络API？然后尽可能保证用户在各种网络环境下都能有良好的体验？
- 页面如何组织，才能尽可能降低业务方代码的耦合度？尽可能降低业务方开发界面的复杂度，提高他们的效率？
- 当数据有在本地存取的需求的时候，如何能够保证数据在本地的合理安排？如何尽可能地减小性能消耗？
- iOS应用有审核周期，如何能够通过不发版本的方式展示新的内容给用户？如何修复紧急bug？

###上面几点是针对App说的，下面还有一些是针对团队说的：
- 收集用户数据，给产品和运营提供参考
- 合理地组织各业务方开发的业务模块，以及相关基础模块
- 每日app的自动打包，提供给QA工程师的测试工具

#架构设计的方法
1. 搞清楚需要解决的问题
2. 问题分类，分模块
3. 搞清楚各个问题之间的依赖关系，建立好模块交流规范和设计模块
4. 推演预测一下未来可能的走向，必要时添加新的模块，记录更多的基础数据以备未来之需
5. 先解决依赖关系中最基础的问题，实现基础模块，	然后用基础模块堆叠出整个架构
6. 打点，跑单元测试，性能测试，根据数据去优化对应的地方  

总而言之就是要遵循这些原则：`自顶向下设计`（1，2，3，4步），`自底向上实现`（5），`先测量，后优化`（6）。  
#什么才是好的架构师
1 每天都在学习，新技术新思想上手快，理解速度快  
>做不到这一点，你就是码农  

2 业务出身，或者至少非常熟悉公司所处行业或者本公司的业务  
>做不到这点，你还是码农  

3 熟悉软件工程的各种规范，踩过无数坑。不会为了完成需求不择手段，不推崇quick & dirty
>做不到这点，你比较适合去竞争对手那儿当工程师

4 及时承认错误，不要觉得承认错误会有损你架构师的身份
>做不到这点，你还是码农

5 不为了炫技而炫技
>做不到这点，你还是码农

5 精益求精
>做不到这点，你还是码农

#什么样的架构算是好的架构
1. 代码整齐，分类明确，没有common，没有core
2. 不用文档，或很少文档，就能让业务方上手
3. 思路和方法要统一，尽量不要多元
4. 没有横向依赖，万不得已不出现跨层访问
5. 对业务方该限制的地方有限制，该灵活的地方要给业务方创造灵活实现的条件
6. 易测试，易拓展
7. 保持一定量的超前性
8. 接口少，接口参数少
9. 高性能

###参考
- [iOS应用架构谈](http://casatwy.com/iosying-yong-jia-gou-tan-kai-pian.html)